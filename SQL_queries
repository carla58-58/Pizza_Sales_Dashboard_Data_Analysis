PIZZA SALES SQL QUERIES
A. KPIs
1. Total Revenue
SELECT * FROM pizza_sales
SELECT SUM(total_price) AS Total_Revenue from pizza_sales
 
2. Average Order Value
SELECT SUM(total_price)/COUNT(DISTINCT order_id) as Avg_Order_Value from pizza_sales
 
3. Total Pizzas Sold
SELECT SUM(quantity) AS Total_Pizza_Sold from pizza_sales
 
4. Total Orders
select count(distinct order_id) as Total_orders from pizza_sales
 
5. Average pizzas per order
select cast(cast(sum(quantity) as decimal(10,2)) /
cast(count(distinct order_id) as decimal(10,2)) as decimal(10,2)) as Avg_Pizzas_Per_Order from pizza_sales
 
B. Charts
1. Daily Trend for Total Orders
SELECT DATENAME(DW, order_date) as order_day, COUNT(DISTINCT order_id) AS Total_orders
from pizza_sales
GROUP BY DATENAME(DW, order_date)
 
2.0. Hourly Trend for Total Orders
SELECT DATENAME(HOUR, order_time) as order_hours, COUNT(DISTINCT order_id) AS Total_orders
from pizza_sales
GROUP BY DATENAME(HOUR, order_time)
ORDER BY Total_orders
 
2. Monthly Trend for Total Orders (by descending orders)
SELECT DATENAME(MONTH, order_date) as Month_Name, COUNT(DISTINCT order_id) AS Total_orders
from pizza_sales
GROUP BY DATENAME(MONTH, order_date)
ORDER BY Total_orders DESC
 
3. Percentage of Sales by Pizza Category
SELECT pizza_category, CAST(SUM (total_price) AS DECIMAL(10,2)) AS Total_revenue, CAST(SUM(total_price) * 100/ (SELECT SUM(total_price) FROM pizza_sales) AS DECIMAL(10,2))
AS Percentage_Total_Sales FROM pizza_sales
GROUP BY pizza_category
 
*Note: Filter for January (1) for example:
SELECT pizza_category, CAST(SUM (total_price) AS DECIMAL(10,2)) AS Total_revenue, CAST(SUM(total_price) * 100/ (SELECT SUM(total_price) FROM pizza_sales WHERE MONTH(order_date)=1) AS DECIMAL(10,2))
AS Percentage_Total_Sales FROM pizza_sales
WHERE MONTH(order_date)=1
GROUP BY pizza_category
 
4.0. Percentage of Sales by Pizza Size (in 1st Quarter: January, February, March)
SELECT pizza_size, CAST(SUM (total_price) AS DECIMAL(10,2)) AS Total_revenue, CAST(SUM(total_price) * 100/ (SELECT SUM(total_price) FROM pizza_sales WHERE DATEPART(QUARTER, order_date)=1) AS DECIMAL (10,2))
AS Percentage_Total_Sales FROM pizza_sales
WHERE DATEPART(QUARTER, order_date)=1
GROUP BY pizza_size
ORDER BY Percentage_Total_Sales DESC
 
4. Percentage of Sales by Pizza Size
SELECT pizza_size, CAST(SUM (total_price) AS DECIMAL(10,2)) AS Total_revenue, CAST(SUM(total_price) * 100/ (SELECT SUM(total_price) FROM pizza_sales) AS DECIMAL (10,2))
AS Percentage_Total_Sales FROM pizza_sales
GROUP BY pizza_size
ORDER BY Percentage_Total_Sales DESC
 

5. Total Pizzas Sold by Pizza Category
SELECT pizza_category, SUM(quantity) AS Total_Quantity_Sold
FROM pizza_sales
WHERE MONTH(order_date)=2
GROUP BY pizza_category
ORDER BY Total_Quantity_Sold DESC
 

6. Top 5 Pizzas by Revenue
SELECT TOP 5 pizza_name, SUM(total_price) AS Total_Revenue FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Revenue DESC
 
7. Bottom 5 Pizzas by Revenue
SELECT TOP 5 pizza_name, SUM(total_price) AS Total_Revenue FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Revenue ASC
 
8. Top 5 Pizzas by Quantity
SELECT TOP 5 pizza_name, SUM(quantity) AS Total_Quantity FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Quantity DESC
 
9. Top 5 Pizzas by Orders
SELECT TOP 5 pizza_name, COUNT(DISTINCT order_id) AS Total_Orders FROM pizza_sales
GROUP BY pizza_name
ORDER BY Total_Orders DESC
 





















